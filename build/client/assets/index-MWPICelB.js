import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t,d as K}from"./components-CqyJs_9b.js";import{A as q}from"./AccountLayout-QOHrx1by.js";import{u as G}from"./AuthContext-BH94oN1s.js";import{u as Q,a as X}from"./zod-DwrW5z8F.js";import{a6 as ee,a7 as F,a8 as V,u as te,f as oe,a9 as se,aa as re,ab as ne,ac as ae,L as ie}from"./lib-d-OCgvip.js";import{I as d}from"./Input-D3HOu0t0.js";import{S as p}from"./Select-BC9R8HZG.js";import{B as ce}from"./Button-7Woa2p3a.js";import{f as le,c as me}from"./css-CVxtJxAn.js";import{T as ue}from"./TextareaWithWordLimit-DQRzKMej.js";import{C as de}from"./CreatePageSchema-Cx5KYOuQ.js";import{u as fe}from"./NotificationContext-CJEyd20o.js";import{u as ge,O as he}from"./OperationContext-BdFCpeXF.js";import{p as pe,P as Se,S as ye,I as xe}from"./SelectCurrency-CKqdQlIJ.js";import{P as we}from"./ProfileContentLayout-D5jIdXrH.js";import{L as Ce}from"./LoadingMessage-B9wZrrAy.js";import"./LeftNav-Cj9_gra7.js";import"./HomeNav-C5gVOegL.js";import"./MainNav-oY7cNyR2.js";import"./index-CTCnFI3k.js";import"./types-DBTFAyTi.js";import"./BusinessMenu-CYgnqm1J.js";const Pe=({data:a,user:i})=>{const[D,S]=t.useState(null),[E,f]=t.useState(!1);fe(),K();const{showOperation:y,showSuccess:g,showError:_,showWarning:W,showInfo:k,completeOperation:x}=ge(),b=a.currencies,w=a.countries;let[T,M]=t.useState(a.states),[I,j]=t.useState(a.cities);const v=ee,[C,c]=t.useState(""),[R,A]=t.useState(""),[P,B]=t.useState(""),[N,L]=t.useState(""),U=async o=>{c(o),B(o);const u=await F(o);M(u),$("")},$=async o=>{A(o),L(o);const u=await V(C,o);j(u)},s=o=>{let u=o.target.value,J=o.target.name;S(l=>({...l,[J]:u}))},Y=async o=>{o.first_name=i.first_name,o.last_name=i.last_name,console.log(o),f(!0),y("processing","Creating a page"),await new Promise(m=>setTimeout(m,1e3)),o.owner=i.guid;const J=oe.BASE_URL+"/api/listing";try{const m=await fetch(J,{method:"POST",headers:te,body:JSON.stringify(o)});if(m.ok)g("success","Page created successfully."),y("processing","Redirecting..."),await new Promise(H=>setTimeout(H,4e3)),window.location.href="/web/account/portfolio",x();else{var l=await m.json();throw new Error(`Error Code: ${m.status} - ${(l==null?void 0:l.message)||(l==null?void 0:l.error)}`)}}catch(m){_("Error",m.message),x()}finally{f(!1)}},{register:r,handleSubmit:O,getValues:z,watch:Z,setValue:h,setError:Ne,formState:{errors:n,isSubmitting:Ee}}=Q({resolver:X(de)});return t.useEffect(()=>{P&&(h("state_code",""),h("city_id",""))},[P]),t.useEffect(()=>{N&&h("city_id","")},[N]),e.jsx("form",{onSubmit:O(Y),children:e.jsxs("div",{className:`${le} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[e.jsx(d,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:r,changeHandler:s,error:n.title,width:80,controlInformation:"Business name is compulsory."}),e.jsx(p,{controlTitle:"Page Type",controlName:"pagetype",controlPlaceholder:"Select Page Type",selectJson:pe,register:r,changeHandler:s,error:n.pagetype,controlInformation:"Select business category."}),e.jsx(d,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:r,changeHandler:s,error:n.email_address,controlInformation:"Email address is compulsory."}),e.jsx(p,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:v,register:r,changeHandler:s,error:n.category,controlInformation:"Select business category."}),e.jsx(d,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:r,changeHandler:s,error:n.address_one,width:100,controlInformation:"Address of Business. E.g. 28 New York Street "}),e.jsx(d,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:r,changeHandler:s,error:n.address_two,width:100,controlInformation:"Continuation of address. E.g. Crown Tower, Off Belleveu Avenue or Valu Complex, Kingston Donnel Boulevard. "}),e.jsx(p,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:w,register:r,changeHandler:s,error:n.country_code,setCode:U,controlInformation:"Country the business was registered or active. "}),e.jsx(p,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:T,register:r,changeHandler:s,error:n.state_code,setCode:$,controlInformation:"State the business is registered or active. "}),e.jsx(p,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:I,register:r,changeHandler:s,error:n.city_id,controlInformation:"City the business is registered or active. "}),e.jsx(d,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:r,changeHandler:s,error:n.zipcode,controlInformation:"Zipcode of location of business. Eg. 92829 or 239484 "}),e.jsx(Se,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:r,setValue:h,getValues:z,changeHandler:s,error:n.phone,controlInformation:"Phone OR Mobile number. "}),e.jsxs("div",{className:"w-full mt-4 mb-12",children:[e.jsx("div",{className:"text-2xl font-semibold",children:"Minimum rate charged by this business."}),e.jsx("div",{className:"text-[14px] py-4 mb-0 leading-[1.3em]",children:"Select the minimum amount customers or clients are charged to purchase goods/services from this business. This is optional."}),e.jsxs("div",{className:"p-4 border rounded-xl",children:[e.jsx(ye,{controlTitle:"Currency",controlName:"minimum_amount_currency_code",controlPlaceholder:"Select currency",selectJson:b,register:r,changeHandler:s,error:n.country_code,setCode:U,controlInformation:"Default currency to receive funds."}),e.jsx("div",{className:"h-2"}),e.jsx(xe,{controlTitle:"Minimum amount charged",controlPlaceholder:"Starting amount. E.g. 10 or 30...",controlName:"minimum_amount",register:r,changeHandler:s,error:n.established,controlInformation:"Enter the starting amount charged by this business"})]})]}),e.jsx(d,{controlTitle:"Year established - Optional",controlPlaceholder:"Enter year established",controlName:"established",register:r,changeHandler:s,error:n.established,controlInformation:"Year registered is compulsory."}),e.jsx(ue,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:r,changeHandler:s,error:n.short_description,setValue:h,getValues:z,watch:Z,controlInformationClass:me,controlInformation:"Enter a short description of this business. It should be a maximum of 50 words. "}),e.jsx(ce,{working:E})]})})},He=()=>{t.useEffect(()=>{localStorage&&se(localStorage)},[localStorage]);const a=G();if(!a)return null;const[i,D]=t.useState(null),[S,E]=t.useState(!0),[f,y]=t.useState(null),[g,_]=t.useState(null),[W,k]=t.useState(null),[x,b]=t.useState(null),[w,T]=t.useState(null),[M,I]=t.useState(null),[j,v]=t.useState(void 0);return t.useEffect(()=>{const C=async c=>{const R=await re(),A=await F(""),P=await V("",""),B=await ne(),N=await ae(),L=await ie((c==null?void 0:c.guid)||"");I(L),_(R),k(A),b(P),T(B),D(c),v(N)};try{a!=null&&a.user&&C(a==null?void 0:a.user)}catch(c){console.log(c.message)}},[a]),t.useEffect(()=>{i&&g&&w&&(y({user:i,countries:g,states:W,cities:x,categories:w,currencies:j}),E(!1))},[g,i]),S?e.jsx(Ce,{loading:S}):e.jsx(q,{children:e.jsx(we,{title:"Create Page",children:e.jsx(he,{children:f&&e.jsx("div",{children:e.jsx(Pe,{data:f,user:i})})})})})};export{He as default};
