import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t,b as K}from"./components-C1WRcSP2.js";import{A as O}from"./AccountLayout-CRUx9ofG.js";import{u as q}from"./AuthContext-D_nN7PrV.js";import{u as G,a as Q}from"./zod-Ctzy-QJu.js";import{a7 as X,a8 as U,a9 as $,t as ee,f as te,aa as oe,ab as se,ac as re,D as ne}from"./lib-BuIQnLor.js";import{I as m}from"./Input-D8Vz1yWW.js";import{S as h}from"./Select-loIF2NAY.js";import{B as ae}from"./Button-7Woa2p3a.js";import{f as ie,c as ce}from"./css-CVxtJxAn.js";import{p as le,T as me}from"./TextareaWithWordLimit-B_l6RVgh.js";import{C as de}from"./CreatePageSchema-5wPOr2lU.js";import{u as ue}from"./NotificationContext-Ctqbimyv.js";import{u as fe,O as ge}from"./OperationContext-S2E0zlUA.js";import{P as pe}from"./ProfileContentLayout-CUQdPJhP.js";import{L as he}from"./LoadingMessage-BwEE7ojk.js";import"./LeftNav-CDndOVO0.js";import"./HomeNav-CfOeOlZw.js";import"./MainNav-Dv-gVLoL.js";import"./index-DxMWeS2U.js";import"./types-DBTFAyTi.js";import"./BusinessMenu-BBIENw49.js";const Se=({data:u,user:a})=>{const[f,_]=t.useState(null),[S,w]=t.useState(!1);ue(),K();const{showOperation:g,showSuccess:N,showError:p,showWarning:k,showInfo:D,completeOperation:y}=fe(),I=u.countries;let[b,C]=t.useState(u.states),[j,J]=t.useState(u.cities);const v=X,[x,i]=t.useState(""),[W,A]=t.useState(""),[P,B]=t.useState(""),[E,z]=t.useState(""),F=async o=>{i(o),B(o);const d=await U(o);C(d),R("")},R=async o=>{A(o),z(o);const d=await $(x,o);J(d)},s=o=>{let d=o.target.value,L=o.target.name;_(c=>({...c,[L]:d}))},V=async o=>{o.first_name=a.first_name,o.last_name=a.last_name,w(!0),g("processing","Creating a page"),await new Promise(l=>setTimeout(l,1e3)),o.owner=a.guid;const L=te.BASE_URL+"/api/listing";try{const l=await fetch(L,{method:"POST",headers:ee,body:JSON.stringify(o)});if(l.ok)N("success","Page created successfully."),g("processing","Redirecting..."),await new Promise(H=>setTimeout(H,4e3)),window.location.href="/web/account/portfolio",y();else{var c=await l.json();throw new Error(`Error Code: ${l.status} - ${(c==null?void 0:c.message)||(c==null?void 0:c.error)}`)}}catch(l){p("Error",l.message),y()}finally{w(!1)}},{register:r,handleSubmit:Y,getValues:M,watch:Z,setValue:T,setError:we,formState:{errors:n,isSubmitting:ye}}=G({resolver:Q(de)});return t.useEffect(()=>{P&&(T("state_code",""),T("city_id",""))},[P]),t.useEffect(()=>{E&&T("city_id","")},[E]),e.jsx("form",{onSubmit:Y(V),children:e.jsxs("div",{className:`${ie} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[e.jsx(m,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:r,changeHandler:s,error:n.title,width:80,controlInformation:"Business name is compulsory."}),e.jsx(h,{controlTitle:"Page Type",controlName:"pagetype",controlPlaceholder:"Select Page Type",selectJson:le,register:r,changeHandler:s,error:n.pagetype,controlInformation:"Select business category."}),e.jsx(m,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:r,changeHandler:s,error:n.email_address,controlInformation:"Email address is compulsory."}),e.jsx(h,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:v,register:r,changeHandler:s,error:n.category,controlInformation:"Select business category."}),e.jsx(m,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:r,changeHandler:s,error:n.address_one,width:100,controlInformation:"Address of Business. E.g. 28 New York Street "}),e.jsx(m,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:r,changeHandler:s,error:n.address_two,width:100,controlInformation:"Continuation of address. E.g. Crown Tower, Off Belleveu Avenue or Valu Complex, Kingston Donnel Boulevard. "}),e.jsx(h,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:I,register:r,changeHandler:s,error:n.country_code,setCode:F,controlInformation:"Country the business was registered or active. "}),e.jsx(h,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:b,register:r,changeHandler:s,error:n.state_code,setCode:R,controlInformation:"State the business is registered or active. "}),e.jsx(h,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:j,register:r,changeHandler:s,error:n.city_id,controlInformation:"City the business is registered or active. "}),e.jsx(m,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:r,changeHandler:s,error:n.zipcode,controlInformation:"Zipcode of location of business. Eg. 92829 or 239484 "}),e.jsx(m,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:r,changeHandler:s,error:n.phone,controlInformation:"Phone OR Mobile number. "}),e.jsx(m,{controlTitle:"Year established - Optional",controlPlaceholder:"Enter year established",controlName:"established",register:r,changeHandler:s,error:n.established,controlInformation:"Year registered is compulsory."}),e.jsx(me,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:r,changeHandler:s,error:n.short_description,setValue:T,getValues:M,watch:Z,controlInformationClass:ce,controlInformation:"Enter a short description of this business. It should be a maximum of 50 words. "}),e.jsx(ae,{working:S})]})})},Fe=()=>{const u=localStorage==null?void 0:localStorage.getItem("authTokens");oe(u);const a=q();if(!a)return null;const[f,_]=t.useState(null),[S,w]=t.useState(!0),[g,N]=t.useState(null),[p,k]=t.useState(null),[D,y]=t.useState(null),[I,b]=t.useState(null),[C,j]=t.useState(null),[J,v]=t.useState(null);return t.useEffect(()=>{const x=async i=>{const W=await se(),A=await U(""),P=await $("",""),B=await re(),E=await ne((i==null?void 0:i.guid)||"");v(E),k(W),y(A),b(P),j(B),_(i)};try{a!=null&&a.user&&x(a==null?void 0:a.user)}catch(i){console.log(i.message)}},[a]),t.useEffect(()=>{f&&p&&C&&(N({user:f,countries:p,states:D,cities:I,categories:C}),w(!1))},[p,f]),S?e.jsx(he,{loading:S}):e.jsx(O,{children:e.jsx(pe,{title:"Create Page",children:e.jsx(ge,{children:g&&e.jsx("div",{children:e.jsx(Se,{data:g,user:f})})})})})};export{Fe as default};
