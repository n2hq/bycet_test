import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t,a as Z}from"./components-QUucBwvO.js";import{A as q}from"./AccountLayout-MQvB5K0v.js";import{u as H}from"./AuthContext-Cl3U3KD_.js";import{u as G,a as Q}from"./zod-BgOlUoe_.js";import{I as X,J as U,K as $,t as ee,g as te,L as oe,N as se,O as re,q as ne}from"./lib-CWKz2Rp4.js";import{I as m}from"./Input-BJdIn08C.js";import{S as p}from"./Select-GpNhjevn.js";import{B as ae}from"./Button-7Woa2p3a.js";import{f as ie,c as ce}from"./css-CVxtJxAn.js";import{p as le,T as de}from"./TextareaWithWordLimit-WiHZM2T2.js";import{C as me}from"./CreatePageSchema-5wPOr2lU.js";import{u as ue}from"./NotificationContext-CMYiNDOq.js";import{u as fe,O as ge}from"./OperationContext-C6xAhjBF.js";import{P as pe}from"./ProfileContentLayout-CCutz_Ps.js";import{L as he}from"./LoadingMessage-BIfhbO4x.js";import"./AccountUserImage-CD1O30HZ.js";import"./HomeNav-Bl3ONTu6.js";import"./MainNav-BDRJ2Bvs.js";import"./index-Dc7kwL7j.js";import"./types-DBTFAyTi.js";import"./BusinessMenu-DxQuaaa1.js";const Se=({data:a,user:i})=>{const[B,h]=t.useState(null),[E,f]=t.useState(!1);ue(),Z();const{showOperation:S,showSuccess:g,showError:N,showWarning:L,showInfo:J,completeOperation:w}=fe(),T=a.countries;let[y,_]=t.useState(a.states),[D,I]=t.useState(a.cities);const C=X,[c,j]=t.useState(""),[W,b]=t.useState(""),[x,v]=t.useState(""),[k,z]=t.useState(""),F=async o=>{j(o),v(o);const u=await U(o);_(u),R("")},R=async o=>{b(o),z(o);const u=await $(c,o);I(u)},s=o=>{let u=o.target.value,A=o.target.name;h(l=>({...l,[A]:u}))},V=async o=>{o.first_name=i.first_name,o.last_name=i.last_name,f(!0),S("processing","Creating a page"),await new Promise(d=>setTimeout(d,1e3)),o.owner=i.guid;const A=te.BASE_URL+"/api/listing";try{const d=await fetch(A,{method:"POST",headers:ee,body:JSON.stringify(o)});if(d.ok)g("success","Page created successfully."),S("processing","Redirecting..."),await new Promise(O=>setTimeout(O,4e3)),window.location.href="/web/account/portfolio",w();else{var l=await d.json();throw new Error(`Error Code: ${d.status} - ${(l==null?void 0:l.message)||(l==null?void 0:l.error)}`)}}catch(d){N("Error",d.message),w()}finally{f(!1)}},{register:r,handleSubmit:Y,getValues:K,watch:M,setValue:P,setError:we,formState:{errors:n,isSubmitting:ye}}=G({resolver:Q(me)});return t.useEffect(()=>{x&&(P("state_code",""),P("city_id",""))},[x]),t.useEffect(()=>{k&&P("city_id","")},[k]),e.jsx("form",{onSubmit:Y(V),children:e.jsxs("div",{className:`${ie} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[e.jsx(m,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:r,changeHandler:s,error:n.title,width:80,controlInformation:"Business name is compulsory."}),e.jsx(p,{controlTitle:"Page Type",controlName:"pagetype",controlPlaceholder:"Select Page Type",selectJson:le,register:r,changeHandler:s,error:n.pagetype,controlInformation:"Select business category."}),e.jsx(m,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:r,changeHandler:s,error:n.email_address,controlInformation:"Email address is compulsory."}),e.jsx(p,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:C,register:r,changeHandler:s,error:n.category,controlInformation:"Select business category."}),e.jsx(m,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:r,changeHandler:s,error:n.address_one,width:100,controlInformation:"Address of Business. E.g. 28 New York Street "}),e.jsx(m,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:r,changeHandler:s,error:n.address_two,width:100,controlInformation:"Continuation of address. E.g. Crown Tower, Off Belleveu Avenue or Valu Complex, Kingston Donnel Boulevard. "}),e.jsx(p,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:T,register:r,changeHandler:s,error:n.country_code,setCode:F,controlInformation:"Country the business was registered or active. "}),e.jsx(p,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:y,register:r,changeHandler:s,error:n.state_code,setCode:R,controlInformation:"State the business is registered or active. "}),e.jsx(p,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:D,register:r,changeHandler:s,error:n.city_id,controlInformation:"City the business is registered or active. "}),e.jsx(m,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:r,changeHandler:s,error:n.zipcode,controlInformation:"Zipcode of location of business. Eg. 92829 or 239484 "}),e.jsx(m,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:r,changeHandler:s,error:n.phone,controlInformation:"Phone OR Mobile number. "}),e.jsx(m,{controlTitle:"Year established - Optional",controlPlaceholder:"Enter year established",controlName:"established",register:r,changeHandler:s,error:n.established,controlInformation:"Year registered is compulsory."}),e.jsx(de,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:r,changeHandler:s,error:n.short_description,setValue:P,getValues:K,watch:M,controlInformationClass:ce,controlInformation:"Enter a short description of this business. It should be a maximum of 50 words. "}),e.jsx(ae,{working:E})]})})},Fe=()=>{t.useEffect(()=>{oe(localStorage)},[]);const a=H();if(!a)return null;const[i,B]=t.useState(null),[h,E]=t.useState(!0),[f,S]=t.useState(null),[g,N]=t.useState(null),[L,J]=t.useState(null),[w,T]=t.useState(null),[y,_]=t.useState(null),[D,I]=t.useState(null);return t.useEffect(()=>{const C=async c=>{const j=await se(),W=await U(""),b=await $("",""),x=await re(),v=await ne((c==null?void 0:c.guid)||"");I(v),N(j),J(W),T(b),_(x),B(c)};try{a!=null&&a.user&&C(a==null?void 0:a.user)}catch(c){console.log(c.message)}},[a]),t.useEffect(()=>{i&&g&&y&&(S({user:i,countries:g,states:L,cities:w,categories:y}),E(!1))},[g,i]),h?e.jsx(he,{loading:h}):e.jsx(q,{children:e.jsx(pe,{title:"Create Page",children:e.jsx(ge,{children:f&&e.jsx("div",{children:e.jsx(Se,{data:f,user:i})})})})})};export{Fe as default};
