import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as a}from"./components-C1WRcSP2.js";import{A as D}from"./AccountLayout-CRUx9ofG.js";import{u as L}from"./AuthContext-D_nN7PrV.js";import{t as U,f as B,aa as I,D as O}from"./lib-BuIQnLor.js";import{u as R,a as k}from"./zod-Ctzy-QJu.js";import{B as C}from"./Button-7Woa2p3a.js";import{I as F}from"./Input-D8Vz1yWW.js";import{o as V,s as W}from"./types-DBTFAyTi.js";import{f as _,g as $}from"./css-CVxtJxAn.js";import{u as H}from"./NotificationContext-Ctqbimyv.js";import{u as J}from"./OperationContext-S2E0zlUA.js";import{P as M}from"./ProfileContentLayout-CUQdPJhP.js";import{L as Y}from"./LoadingMessage-BwEE7ojk.js";import"./LeftNav-CDndOVO0.js";import"./HomeNav-CfOeOlZw.js";import"./MainNav-Dv-gVLoL.js";import"./index-DxMWeS2U.js";import"./BusinessMenu-BBIENw49.js";const q=V({email:W({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),z=({loaderData:s,user:t})=>{var P,w,j;const[r,g]=a.useState(null),[o,f]=a.useState(!1);H();const{showOperation:d,showError:p,completeOperation:n,showSuccess:c}=J(),v=i=>{let m=i.target.value,y=i.target.name;g(x=>({...x,[y]:m}))},E=async i=>{var b;f(!0);let m="";s.userProfile.active?m="Deactivating...":m="Activating...",d("processing",m),await new Promise(l=>setTimeout(l,1e3));const x="/api/user/activate_deactivate/"+s.userProfile.user_guid,T=B.BASE_URL+x;i.active=!((b=s.userProfile)!=null&&b.active);try{const l=await fetch(T,{method:"PUT",headers:U,body:JSON.stringify(i)});if(l.ok){let S=i.active?"Activated.":"Deactivated.";c("Success",S),await new Promise(u=>setTimeout(u,1e3)),d("processing","Refreshing..."),await new Promise(u=>setTimeout(u,4e3)),window.location.reload(),n()}else{let S=l.json().then(u=>{p("Error",u.message),n()})}}catch(l){console.log(l.message),p("Error","Process not completed.")}finally{f(!1)}},{register:A,handleSubmit:N,getValues:G,setValue:K,watch:Q,setError:X,formState:{errors:h,isSubmitting:Z}}=R({defaultValues:s.userProfile,resolver:k(q)});return e.jsx("form",{onSubmit:N(E),children:e.jsx("div",{className:`${_} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:$,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(P=s.userProfile)!=null&&P.active?"Deactivate User":"Activate User"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(w=s.userProfile)==null?void 0:w.email})," is your current email. It will be used for password resets or changes."]}),e.jsx("div",{className:"mt-[10px]"}),e.jsx(F,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:A,changeHandler:v,error:h==null?void 0:h.email}),e.jsx(C,{working:o,value:`${(j=s.userProfile)!=null&&j.active?"Deactivate":"Activate"} Profile`})]})})})},Pe=()=>{a.useEffect(()=>{I(localStorage)},[]);const s=L();if(!s)return null;const{user:t}=s,[r,g]=a.useState(null),[o,f]=a.useState(null),[d,p]=a.useState(!0);return a.useEffect(()=>{async function n(c){const v=await O(c||"");g(v)}try{t!=null&&t.guid&&n(t==null?void 0:t.guid)}catch(c){console.log(c.message)}},[t==null?void 0:t.guid]),a.useEffect(()=>{r&&f({userProfile:r})},[r]),a.useEffect(()=>{o&&p(!1)},[o]),d?e.jsx(Y,{}):e.jsx(D,{children:e.jsxs(M,{title:r.active?"Deactivate Profile":"Activate Profile",children:[r===null?"Loading...":"",o&&e.jsx(z,{loaderData:o,user:t})]})})};export{Pe as default};
