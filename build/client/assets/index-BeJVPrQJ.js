import{j as s}from"./jsx-runtime-0DLF9kdB.js";import{r as a,c as E}from"./components-DGrJwBOK.js";import{p as k,a3 as A,l as C,a6 as N,a7 as L,a8 as P,a9 as B}from"./lib-k8WFHaWl.js";import{A as O}from"./AccountLayout-Di9ppq2K.js";import{C as D}from"./ContentLayout-BGkoTUxR.js";import{u as R}from"./NotificationContext-COGTy5tS.js";import{u as T}from"./OperationContext-Cntcaxvx.js";import{u as U}from"./AuthContext-BZd2vK8z.js";import{L as M}from"./LoadingMessage-uYfV-qmv.js";import"./LeftNav-B93XguDD.js";import"./HomeNav-BIeS0P5q.js";import"./MainNav-rFCMO_E8.js";import"./index-BcoEYQqA.js";import"./BusinessMenu-DbEWNtrr.js";import"./BusinessDrawer-CedorsPW.js";const $=({businessGuid:c,userGuid:j,facilityFeatures:o,selectedFacilityFeatures:f})=>{const[h,S]=a.useState(!1);R();const[n,v]=a.useState(null),[u,F]=a.useState(null),[p,g]=a.useState(null),{showOperation:x,showError:m,completeOperation:l,showSuccess:b}=T();a.useEffect(()=>{o&&f&&(v(o),F(f))},[o,f]),a.useEffect(()=>{if(n&&u){const e=n.map(i=>{const t=u.find(r=>r.feature_id===i.feature_id);return{...i,active:!!t,user_description:t?t.user_description:void 0}});g(e)}},[n,u]);const w=e=>{g(i=>i.map(t=>t.feature_id===e?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},_=(e,i)=>{g(t=>t.map(r=>r.feature_id===e?{...r,user_description:i}:r))},d=async()=>{const t="https://test.bycet.com"+"/api/listing/selected_facility_features";S(!0),x("processing"),await new Promise(r=>setTimeout(r,1e3));try{const r=p.filter(y=>y.active).map(y=>({feature_id:y.feature_id,user_description:y.user_description}));(await fetch(t,{method:"POST",headers:k,body:JSON.stringify({user_guid:j,business_guid:c,selected:r})})).ok?(b("Success","Features saved."),l()):(m("Error","Save failed."),l())}catch(r){console.log(r.message),m("Error","Save failed.")}finally{S(!1)}};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),o.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p==null?void 0:p.map(e=>s.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[s.jsxs("div",{children:[s.jsx("input",{onChange:()=>w(e.feature_id),type:"checkbox",checked:e.active,className:"hidden"}),s.jsx("div",{className:`w-5 h-5 border-2 rounded ${e.active?"bg-blue-700":"bg-white"}`})]}),s.jsxs("div",{className:" w-full",children:[s.jsxs("p",{className:"font-medium flex place-items-center gap-2 text-lg",children:[s.jsx("span",{className:"text-lg",children:e.icon}),s.jsx("span",{children:e.name})]}),s.jsx("p",{className:"text-xs ",children:e.description}),s.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:s.jsx("textarea",{onClick:()=>w(e.feature_id),onChange:i=>_(e.feature_id,i.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm rounded-md`,value:e.user_description})})]})]},e.feature_id))}),s.jsx("button",{onClick:d,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},ie=()=>{a.useEffect(()=>{A(localStorage)},[]);const[c,j]=a.useState(""),[o,f]=a.useState(""),[h,S]=a.useState(null),[n,v]=a.useState(null),[u,F]=a.useState(null),[p,g]=a.useState(!0),{business_guid:x,user_guid:m}=E(),[l,b]=a.useState(null);return U()?(a.useEffect(()=>{const _=async(d,e)=>{j(d),f(e),await L(),S(N);const i=await P(e,d);v(i);const t=await B(d||"");b(t)};try{x&&m&&_(x,m)}catch(d){C(d)}},[x,m,N]),a.useEffect(()=>{c&&o&&h&&n&&l&&(F({businessGuid:c,userGuid:o,facilityFeatures:h,selectedFacilityFeatures:n,businessProfile:l}),g(!1))},[c,o,h,n,l]),p?s.jsx(M,{}):s.jsx(O,{children:s.jsx(D,{businessGuid:c,data:u,businessProfile:l,title:"Facility Features",children:u&&s.jsx($,{userGuid:o,businessGuid:c,facilityFeatures:h,selectedFacilityFeatures:n})})})):null};export{ie as default};
