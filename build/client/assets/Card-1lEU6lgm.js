import{j as a}from"./jsx-runtime-0DLF9kdB.js";import{r as o}from"./components-DGrJwBOK.js";import{f as y,s as l,g as M,h as U,i as G,j as P,k as b,m as W,n as D}from"./lib-7lwFdP97.js";const X=({listing:e})=>{var _;const p="/images/fallbackBusinessImg.png",[m,w]=o.useState("/images/bycetplaceholder.png"),[k,f]=o.useState(""),[S,t]=o.useState(""),[h,z]=o.useState(null),[I,N]=o.useState(""),[c,A]=o.useState(null),[s,B]=o.useState(null),[R,C]=o.useState("");return o.useEffect(()=>{if(e){const d=e;A(d),d!=null&&d.image_url?f(y.IMG_BASE_URL+(d==null?void 0:d.image_url)):f(m)}},[e]),o.useEffect(()=>{e!=null&&e.website?N(e==null?void 0:e.website):(e==null?void 0:e.username)===""||(e==null?void 0:e.username)===null?N("/"+(e==null?void 0:e.gid)):N("/"+(e==null?void 0:e.username))},[e]),o.useEffect(()=>{e&&((e==null?void 0:e.image_url)!==""&&(e==null?void 0:e.image_url)!==null&&(e==null?void 0:e.image_url)!==void 0?f(y.IMG_BASE_URL+(e==null?void 0:e.image_url)):f(m),(e==null?void 0:e.username)!==""&&(e==null?void 0:e.username)!==null&&(e==null?void 0:e.username)!==void 0?t(e==null?void 0:e.username):t(e==null?void 0:e.gid))},[e]),o.useEffect(()=>{if(e!=null&&e.social_media){let d=[];const r=l(e==null?void 0:e.social_media,",");r!==null&&(r==null||r.map((x,j)=>{const v=l(x,"$"),u={mediaName:v[0],mediaHandle:v[1],baseUrl:v[2]};console.log(u),d.push(u)})),z(d)}},[e]),o.useEffect(()=>{},[h]),o.useEffect(()=>{if(c!=null&&c.facility_features){let d=[];const r=l(c==null?void 0:c.facility_features,"&");r!==null&&(r==null||r.map((j,v)=>{const u=l(j,"$"),F={featureId:u[0],userDescription:u[1]};d.push(F)}));const x=M(d);B(x)}},[c]),o.useEffect(()=>{e!==null&&(async r=>{let x=r==null?void 0:r.title;x+=r!=null&&r.address_one?", "+(r==null?void 0:r.address_one):"",x+=r!=null&&r.address_two?", "+(r==null?void 0:r.address_two):"",x+=r!=null&&r.city_name?", "+(r==null?void 0:r.city_name):"",x+=r!=null&&r.state_name?", "+(r==null?void 0:r.state_name):"",x+=r!=null&&r.zipcode?", "+(r==null?void 0:r.zipcode):"",x+=r!=null&&r.country_name?", "+(r==null?void 0:r.country_name):"";let j=`https://www.google.com/maps/search/?api=1&query=${x}`;C(j)})(e)},[e]),a.jsxs("div",{className:"bg-white w-full h-auto  overflow-hidden border   hover:shadow-md hover:shadow-gray-200 md:rounded-xl",children:[a.jsx("div",{className:"bg-gray-50/30 py-3 px-4 border-b-0",children:a.jsxs("a",{href:`/${S}`,children:[a.jsxs("div",{className:"flex place-content-between gap-2",children:[a.jsxs("div",{className:"flex place-items-start gap-2 w-full",children:[a.jsx("div",{className:"max-w-[85px] h-[90px] min-w-[85px]   bg-gray-50  relative border flex place-items-center place-content-center  overflow-hidden shadow-xl shadow-gray-400/30",children:(e==null?void 0:e.image_url)!==null?a.jsx("img",{src:k,alt:"",className:` w-full h-auto text-sm
                             z-0 bg-gray-100 `}):a.jsx("div",{className:"h-full w-full  md:p-3",children:a.jsx("img",{src:p,alt:""})})}),a.jsxs("div",{className:" w-full",children:[a.jsx("div",{className:"text-[18px] font-normal text-blue-800 line-clamp-1 w-full",children:e==null?void 0:e.title}),(e==null?void 0:e.category)&&a.jsx("div",{className:"text-[12px] text-gray-500  capitalize mt-[0px]",children:(_=U(e==null?void 0:e.category))==null?void 0:_.name}),a.jsxs("div",{className:"flex place-items-center gap-x-1 mt-[5px] ",children:[a.jsx("div",{children:(c==null?void 0:c.rating_average)!==null&&(c==null?void 0:c.rating_average)!==""&&(c==null?void 0:c.rating_average)!==void 0?a.jsxs("div",{className:" flex gap-2 place-items-center",children:[a.jsx($,{rating:Number(c==null?void 0:c.rating_average)}),a.jsx(E,{averageRating:c==null?void 0:c.rating_average})]}):a.jsxs("div",{className:" flex gap-2 place-items-center",children:[a.jsx($,{rating:0}),a.jsx(E,{averageRating:0})]})}),a.jsxs("div",{className:" ",children:[Number(c==null?void 0:c.rating_count)>0?c==null?void 0:c.rating_count:0," Reviews"]})]})]})]}),a.jsx("div",{className:"flex place-items-start",children:a.jsx("div",{className:"font-bold rounded-sm border px-3 py-[2px]",children:"View"})})]}),a.jsx("div",{className:"mt-[8px] text-[14px] md:text-[13px] text-gray-800 leading-[1.3em] line-clamp-3",children:e==null?void 0:e.short_description})]})}),a.jsx("div",{children:a.jsxs("div",{className:" h-auto flex place-content-between gap-2 ",children:[a.jsxs("div",{className:"flex place-items-start w-[60%] flex-col  pl-4  pt-2 pb-4 ",children:[a.jsxs("div",{className:"flex place-items-center gap-x-1",children:[a.jsx(G,{}),a.jsxs("span",{className:"mt-[1px] text-gray-500 space-x-2",children:[a.jsx("span",{className:"font-bold",children:"Founded:"}),a.jsx("span",{children:e==null?void 0:e.established})]})]}),s!==null&&a.jsxs("div",{className:"mt-2 flex place-items-start gap-2 w-full relative",children:[a.jsx("span",{className:"text-[13px]",children:"Facilities: "}),a.jsx("div",{className:"flex place-items-baseline gap-3 flex-wrap leading-[0.9em] ",children:s==null?void 0:s.map((d,r)=>a.jsx(O,{tooltip:`${d==null?void 0:d.name}: ${(d==null?void 0:d.userDescription)||""}`,children:a.jsx("div",{className:"text-[15px]",children:d==null?void 0:d.icon})},r))})]})]}),a.jsxs("div",{className:"flex place-items-end flex-col w-[40%] text-end pr-4 pt-2 pb-4",children:[a.jsx("div",{className:"font-[600]",children:e==null?void 0:e.phone}),a.jsx("div",{className:"text-[12px] leading-[1.2em] mt-1",children:a.jsx(H,{listing:e})})]})]})}),a.jsx("div",{className:"border-none",children:a.jsxs("div",{className:"flex place-content-between mx-4 my-1",children:[a.jsxs("div",{className:"flex place-items-center gap-4",children:[a.jsx("a",{href:`mailto:${e==null?void 0:e.email_address}`,children:a.jsx(P,{size:20})},34),(e==null?void 0:e.phone)&&a.jsx("a",{href:`tel:${e==null?void 0:e.phone}`,children:a.jsx(b,{size:20})},30),h!==null&&(h==null?void 0:h.map((d,r)=>a.jsx("a",{href:`${d==null?void 0:d.baseUrl}${d==null?void 0:d.mediaHandle}`,children:W(d==null?void 0:d.mediaName)},r)))]}),a.jsx("div",{className:"px-1.5 py-0.5 bg-red-500 rounded hover:shadow-lg text-white",children:a.jsx("a",{href:`${I}`,children:"Website"})})]})}),a.jsx("div",{className:"px-4 mb-4 mt-8",children:a.jsxs("div",{className:" grid grid-cols-2 gap-2 w-full md:w-[50%]",children:[a.jsx("a",{target:"_blank",href:`${R}`,className:"border border-blue-400 py-[5px] rounded px-2 font-semibold w-full text-center",children:"Go to map"}),a.jsx("div",{children:(c==null?void 0:c.phone)&&a.jsx("a",{href:`tel:${c==null?void 0:c.phone}`,children:a.jsxs("button",{className:"bg-gray-500 rounded w-full text-white flex place-items-center place-content-center text-[15px] gap-2 py-[5px]",children:[a.jsx(b,{size:20,className:"mt-[2px]"}),a.jsx("span",{children:"Call"})]})})})]})})]})};function $({rating:e}){return a.jsx("div",{className:"flex gap-x-[2px]",children:Array.from({length:5}).map((p,m)=>{const w=Math.max(0,Math.min(1,e-m))*100;return a.jsx("div",{className:`relative w-[17px] h-[17px] bg-white rounded-full 
                            overflow-hidden flex place-items-center border-[1px]
                            place-content-center border-gray-500`,children:a.jsx("div",{className:"absolute inset-0 bg-green-600 z-[0]",style:{width:`${w}%`}})},m)})})}const E=({averageRating:e})=>{const[p,m]=o.useState(0);return o.useEffect(()=>{e!=null&&m(e)},[e]),a.jsxs("div",{className:"text-blue-700",children:["(",D(Number(p)),")"]})},H=({listing:e})=>a.jsxs("div",{children:[e==null?void 0:e.address_one,e!=null&&e.address_two?`, ${e==null?void 0:e.address_two}`:"",e!=null&&e.city_name?`, ${e==null?void 0:e.city_name}`:"",e!=null&&e.state_name?`, ${e==null?void 0:e.state_name}`:"",e!=null&&e.country_name?`, ${e==null?void 0:e.country_name}`:""]}),O=({tooltip:e,children:p})=>a.jsx("div",{className:"block",children:a.jsxs("a",{href:"#",className:"tooltip z-[20000] relative  ","data-tooltip":e,children:[p,a.jsx("style",{children:`
                    .tooltip{
                        position:relative;
                        display: inline-block;
                        cursor: pointer;
                        text-decoration: underline;
                    }

                    .tooltip::after{
                        content:attr(data-tooltip);
                        position: absolute;
                        bottom: 125%;
                        left: 50%;
                        transform: translateX(-20px);
                        background-color: blue;
                        color: #fff;
                        padding: 6px 8px;
                        border-radius: 4px;
                        white-space: normal;
                        max-width: 250px; 
                        min-width: 200px; 
                        word-wrap: break-word;
                        opacity: 0;
                        pointer-events: none;
                        transition: opacity 0.2s ease-in-out;
                        font-size: 11px;
                        z-index: 999;
                        line-height:1.4em;
                    }

                    .tooltip:hover::after{
                        opacity: 1;
                    }
                    `})]})});export{X as C};
